<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STAFF DOCS - Checagem Semanal</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        /* CSS Reset básico e estilos gerais */
        body, html {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background-color: #f0f0f0; /* Cor de fundo padrão */
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            background-image: url('images/image-1-ChCoY1tK.jpg'); /* Alterne aqui para dKTzMk.jpg se preferir */
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }

        .main-content-wrapper {
            max-width: 1280px;
            width: 95%;
            margin: 20px auto;
            background-color: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            box-sizing: border-box;
        }

        /* Estilos da Tabela Principal */
        .grid-container {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 10px;
            border: 1px solid #ddd; /* Borda externa da grid */
            border-radius: 5px;
            overflow: hidden; /* Garante que bordas internas não vazem */
        }

        .grid-header, .grid-cell {
            padding: 15px;
            box-sizing: border-box;
            font-weight: bold;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            color: #fff;
            font-size: 0.95em;
            border-right: 1px solid rgba(255, 255, 255, 0.3);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }
        .grid-header:last-child, .grid-cell:nth-child(4n) {
            border-right: none;
        }
        .grid-header {
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* Cores dos cabeçalhos */
        .header-blue { background-color: #4CAF50; }
        .header-lightgreen { background-color: #8BC34A; }
        .header-orange { background-color: #FF9800; }
        .header-lightblue { background-color: #03A9F4; }

        /* Cores das células de conteúdo */
        .cell-general-yellow { background-color: #FFEB3B; color: #333; }
        .cell-general-lightyellow { background-color: #FFF9C4; color: #333; }
        .cell-list-item { background-color: #E8F5E9; color: #333; text-align: left; font-weight: normal; font-size: 0.9em; }
        .cell-updates-yellow { background-color: #FFEB3B; color: #333; }

        .cell-list-item ul {
            list-style: none;
            padding: 0;
            margin: 0;
            width: 100%;
        }

        .cell-list-item li {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
            gap: 5px;
            flex-wrap: wrap;
            padding-bottom: 5px;
            border-bottom: 1px dashed #ccc;
        }
        .cell-list-item li:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            flex-grow: 1;
            gap: 5px;
        }

        .checkbox-label input[type="checkbox"] {
            min-width: 15px;
            min-height: 15px;
        }
        
        .checkbox-label input[type="date"] {
            margin-left: auto;
            padding: 3px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 0.85em;
            flex-shrink: 0;
        }


        /* Estilo para os "quadros" da primeira coluna */
        .first-column-box {
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: normal;
            padding-bottom: 10px;
            border-bottom: 1px dashed #ccc;
            flex-wrap: wrap;
        }
        .first-column-box:last-of-type {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        /* Estilo para a caixa de "Atualizações" */
        .updates-section {
            grid-column: 1 / -1;
            text-align: left;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            font-weight: normal;
            background-color: #FFEB3B;
        }
        .updates-section h3 {
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 1.1em;
            text-align: center;
            font-weight: bold;
            color: #333;
        }
        .updates-section .checkbox-label {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            padding-bottom: 5px;
            border-bottom: 1px dashed #ccc;
            margin-bottom: 5px;
        }
        .updates-section .checkbox-label:last-of-type {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        .updates-section br { display: none; }


        /* --- ESTILOS PARA "PONTOS IMPORTANTES" --- */
        .important-points-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 30px;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
        }

        .points-header {
            padding: 15px;
            border-radius: 0;
            text-align: center;
            font-weight: bold;
            color: #333;
            font-size: 1.1em;
            background-color: #ADD8E6;
            border-right: 1px solid rgba(0,0,0,0.1);
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }
        .points-header:last-child {
            border-right: none;
        }
        
        .points-content {
            background-color: #FFDDEE;
            padding: 15px;
            color: #333;
            font-size: 0.9em;
            text-align: left;
            border-right: 1px solid rgba(0,0,0,0.1);
        }
        .points-content:last-child {
            border-right: none;
        }

        .points-content p {
            margin: 0;
            padding-bottom: 8px;
            border-bottom: 1px dashed #ccc;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            line-height: 1.4;
            gap: 4px;
        }
        .points-content p:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .point-textbox {
            width: calc(100% - 10px);
            padding: 5px;
            margin-top: 0px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 0.9em;
        }

        /* Estilos para o botão de download */
        .download-button-container {
            text-align: center;
            margin-top: 20px;
            padding-top: 10px;
            border-top: 1px solid #eee;
        }
        .download-button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s ease;
        }
        .download-button:hover {
            background-color: #45a049;
        }

        /* Novo estilo para o botão "Desmarcar Todas" */
        .clear-all-button {
            padding: 10px 15px;
            background-color: #f44336; /* Cor vermelha para desmarcar */
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: background-color 0.3s ease;
            width: 100%; /* Ocupar a largura do container */
            box-sizing: border-box; /* Incluir padding e border na largura */
            margin-bottom: 10px; /* Adiciona um espaço abaixo do botão */
        }
        .clear-all-button:hover {
            background-color: #da190b;
        }


        /* Responsividade para ambas as seções */
        @media (max-width: 768px) {
            .grid-container, .important-points-grid {
                grid-template-columns: 1fr;
            }
            .grid-header, .points-header {
                text-align: left;
            }
            .grid-header:not(:last-child), .points-header:not(:last-child),
            .grid-cell:not(:last-child), .points-content:not(:last-child) {
                border-right: none;
            }
        }
    </style>
</head>
<body>
    <div class="main-content-wrapper">
        <div class="grid-container">
            <div class="grid-header header-blue">Geral (General)</div>
            <div class="grid-header header-lightgreen">Semanalmente (Weekly)</div>
            <div class="grid-header header-orange">Atividades da semana (Weekly Activities)</div>
            <div class="grid-header header-lightblue">Eventos (Events)</div>

            <div class="grid-cell cell-general-yellow">
                <button type="button" class="clear-all-button" id="clearAllCheckboxesButton">Desmarcar Todas</button>

                <div class="first-column-box">
                    <label class="checkbox-label">
                        Esta lista é para referência do que deve ser checado semanalmente. (This list is for reference of what should be checked on a weekly basis.)
                        </label>
                    </div>
            </div>

            <div class="grid-cell cell-list-item">
                <ul>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_event_entry"> Novos Servers <input type="date" class="date-picker" id="date_semanal_event_entry"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_event_entry"> Entrada de eventos (Event Entry)<input type="date" class="date-picker" id="date_semanal_event_entry"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_vip_discount"> Desconto VIP (VIP Discount)<input type="date" class="date-picker" id="date_semanal_vip_discount"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_pact_discount"> Desconto Pacto (Pact Discount)<input type="date" class="date-picker" id="date_semanal_pact_discount"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_figures"> Figuras (Figures)<input type="date" class="date-picker" id="date_semanal_figures"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_ammo_sale"> Venda de Munição (Ammo Sale)<input type="date" class="date-picker" id="date_semanal_ammo_sale"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_limited_event"> Evento Limitado (Limited Event)<input type="date" class="date-picker" id="date_semanal_limited_event"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_recharge"> - Recarga (Recharge)<input type="date" class="date-picker" id="date_semanal_recharge"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_consumption"> - Consumo (Consumption)<input type="date" class="date-picker" id="date_semanal_consumption"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_mount"> - Montaria (Mount)<input type="date" class="date-picker" id="date_semanal_mount"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_temple"> - Templo (Temple)<input type="date" class="date-picker" id="date_semanal_temple"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_estimate_treasure"> - Estime tesouro (Estimate Treasure)<input type="date" class="date-picker" id="date_semanal_estimate_treasure"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_recharge_master"> - Mestre de Recarga (Recharge Master)<input type="date" class="date-picker" id="date_semanal_recharge_master"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_check_quantities_1"> - Checar quantidades (Check Quantities)<input type="date" class="date-picker" id="date_semanal_check_quantities_1"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_consumption_master"> - Mestre de Consumo (Consumption Master)<input type="date" class="date-picker" id="date_semanal_consumption_master"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_check_quantities_2"> - Checar quantidades (Check Quantities)<input type="date" class="date-picker" id="date_semanal_check_quantities_2"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_new_missions"> Novas Missões (New Missions)<input type="date" class="date-picker" id="date_semanal_new_missions"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_coupons_collecting"> Coletas de Cupons (Cupons Collecting)<input type="date" class="date-picker" id="date_semanal_coupons_collecting"></label></li>
                </ul>
            </div>
            <div class="grid-cell cell-list-item">
                <ul>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_atividades_budai"> Deus da Fortuna (Budai) (God of Fortune - Buddha)<input type="date" class="date-picker" id="date_atividades_budai"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_atividades_treasure"> Tesouro do Diabo (Devil's Treasure)<input type="date" class="date-picker" id="date_atividades_treasure"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_atividades_popfull"> Pop-full (Dream Dungeon)<input type="date" class="date-picker" id="date_atividades_popfull"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_atividades_adventure"> Aventura (Adventure)<input type="date" class="date-picker" id="date_atividades_adventure"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_atividades_shooting_balloons"> Balões de Atrar fogos (balões) (Shooting Balloons (balloons))<input type="date" class="date-picker" id="date_atividades_balloons"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_atividades_puzzle"> Quebra-cabeça (Puzzle)<input type="date" class="date-picker" id="date_atividades_puzzle"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_atividades_lucky_star"> Estrela da sorte (Lucky Star)<input type="date" class="date-picker" id="date_atividades_lucky_star"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_atividades_dd_destiny"> DD Destino (DD Destiny)<input type="date" class="date-picker" id="date_atividades_dd_destiny"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_atividades_wheel_of_destiny"> Roda do Destino (Wheel of Destiny)<input type="date" class="date-picker" id="date_atividades_wheel_of_destiny"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_atividades_ddt_delight"> DDT Delícia (DDT Delight)<input type="date" class="date-picker" id="date_atividades_ddt_delight"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_atividades_flower_event"> Evento das Flores (Flower Event)<input type="date" class="date-picker" id="date_atividades_flower_event"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_atividades_chaos_insects"> Caos Insetos (Chaos Insects)<input type="date" class="date-picker" id="date_atividades_chaos_insects"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_atividades_sacred_card"> Cartão Sagrado (cartas) (Sacred Card)<input type="date" class="date-picker" id="date_atividades_sacred_card"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_atividades_dd_lottery"> DD Loteria (DD Lottery)<input type="date" class="date-picker" id="date_atividades_dd_lottery"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_atividades_joyful_ddt"> DDT Alegre (Joyful DDT)<input type="date" class="date-picker" id="date_atividades_joyful_ddt"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox"> Pirâmides (Pirámides)<input type="date" class="date-picker" id="date_atividades_pyramids"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox"> Fazenda (Farm)<input type="date" class="date-picker" id="date_atividades_farm"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox"> Masmorra (Dungeon)<input type="date" class="date-picker" id="date_atividades_dungeon"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox"> Em pares (In pairs)<input type="date" class="date-picker" id="date_atividades_em_pares"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_batalha_nebulosa"> Batalha Nebulosa (Nebula Battle) <input type="date" class="date-picker" id="date_semanal_batalha_nebulosa"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_resgate"> Resgate (Rescue) <input type="date" class="date-picker" id="date_semanal_resgate"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_recarga_continua"> Recarga Contínua (Continuous Recharge) <input type="date" class="date-picker" id="date_semanal_recarga_continua"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_recarga_atividade"> Recarga (Atividade) (Recharge - Activity) <input type="date" class="date-picker" id="date_semanal_recarga_atividade"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_doacao"> Doação (Donation) <input type="date" class="date-picker" id="date_semanal_doacao"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_invasao_equipe"> Invasão em Equipe (Team Invasion) <input type="date" class="date-picker" id="date_semanal_invasao_equipe"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_medo"> Medo (Fear) <input type="date" class="date-picker" id="date_semanal_medo"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_arena_rei"> Arena do Rei (King's Arena) <input type="date" class="date-picker" id="date_semanal_arena_rei"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_campo_provas"> Campo de Provas (Proving Ground) <input type="date" class="date-picker" id="date_semanal_campo_provas"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_torneio"> Torneio (Tournament) <input type="date" class="date-picker" id="date_semanal_torneio"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_rank_atletismo"> Rank Atletismo (Athletics Rank) <input type="date" class="date-picker" id="date_semanal_rank_atletismo"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_artes_marciais"> Artes Marciais (Martial Arts) <input type="date" class="date-picker" id="date_semanal_artes_marciais"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_fundo_gestao"> Fundo de Gestão (Management Fund) <input type="date" class="date-picker" id="date_semanal_fundo_gestao"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_checkin"> Check-in (Check-in) <input type="date" class="date-picker" id="date_semanal_checkin"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_desafio_pet"> Desafio Pet (Pet Challenge) <input type="date" class="date-picker" id="date_semanal_desafio_pet"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_semanal_entrada_diaria"> Entrada Diária (Daily Entry) <input type="date" class="date-picker" id="date_semanal_entrada_diaria"></label></li>
                </ul>
            </div>
            <div class="grid-cell cell-list-item">
                <ul>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_eventos_daily"> Entrada diária (Daily Entry)<input type="date" class="date-picker" id="date_eventos_daily"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_eventos_missions"> Missões (Missions)<input type="date" class="date-picker" id="date_eventos_missions"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_eventos_instances"> Instâncias (Instances)<input type="date" class="date-picker" id="date_eventos_instances"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_eventos_battles"> Combates (Battles)<input type="date" class="date-picker" id="date_eventos_battles"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_eventos_exchange_activity"> Atividade de troca (Exchange Activity)<input type="date" class="date-picker" id="date_eventos_exchange_activity"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_eventos_event_date"> - Data do evento (Event Date)<input type="date" class="date-picker" id="date_eventos_event_date"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_eventos_ammunition_sale"> - Venda de Munição (Ammunition Sale)<input type="date" class="date-picker" id="date_eventos_ammunition_sale"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_eventos_only_coupons"> - Só cupons (Cupons only)<input type="date" class="date-picker" id="date_eventos_only_coupons"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_eventos_coupons_and_lcoupons_2"> - Cupons e L.Cupons (Cupons and L.Cupons)<input type="date" class="date-picker" id="date_eventos_coupons_and_lcoupons_2"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_eventos_transformation_event_2"> - Evento de Transformação (Transformation Event)<input type="date" class="date-picker" id="date_eventos_transformation_event_2"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_eventos_items"> Itens (Items)<input type="date" class="date-picker" id="date_eventos_items"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_eventos_quantity_values"> Quantidade/ Valores (Quantity/Values)<input type="date" class="date-picker" id="date_eventos_quantity_values"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_eventos_coupons"> Cupons e L.Cupons (Cupons e L.Cupons)<input type="date" class="date-picker" id="date_eventos_coupons"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_eventos_transformation_event"> Evento de Transformação (Transformation Event)<input type="date" class="date-picker" id="date_eventos_transformation_event"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_eventos_nien"> Nien (Nien)<input type="date" class="date-picker" id="date_eventos_nien"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_eventos_old_player_return"> Retorno Antigo Jogador (Old Player Return)<input type="date" class="date-picker" id="date_eventos_old_player_return"></label></li>
                    <li><label class="checkbox-label"><input type="checkbox" id="chk_eventos_recharge_event"> Recarga (eventos) (Recharge - Event)<input type="date" class="date-picker" id="date_eventos_recharge_event"></label></li>
                </ul>
            </div>

            <div class="updates-section cell-updates-yellow">
                <h3>Atualizações (Updates)</h3>
                <label class="checkbox-label">
                    <input type="checkbox" id="chk_updates_1">
                    Checar TUDO no sistema, printar e construir dois docs, um sobre o que entrou de novo e outro sobre bug/erros que foram apresentados. (Check EVERYTHING in the system, print it out and build two docs, one about what has come in new and another about bug/errors that have been displayed.)
                    <input type="date" class="date-picker" id="date_updates_1">
                </label>
                <br>
                <label class="checkbox-label">
                    <input type="checkbox" id="chk_updates_others">
                    (Outros) (Others)
                    <input type="date" class="date-picker" id="date_updates_others">
                </label>
            </div>
            
            <div class="grid-cell cell-list-item">
                <label class="checkbox-label">
                    <input type="checkbox" id="chk_col2_others">
                    (Outros) (Others)
                    <input type="date" class="date-picker" id="date_col2_others">
                </label>
            </div>
            <div class="grid-cell cell-list-item">
                <label class="checkbox-label">
                    <input type="checkbox" id="chk_col3_others">
                    (Outros) (Others)
                    <input type="date" class="date-picker" id="date_col3_others">
                </label>
            </div>
            <div class="grid-cell cell-list-item">
                <label class="checkbox-label">
                    <input type="checkbox" id="chk_col4_others">
                    (Outros) (Others)
                    <input type="date" class="date-picker" id="date_col4_others">
                </label>
            </div>
        </div>

        <div class="important-points-grid">
            <div class="points-header">Pontos importantes a se atentar:</div>
            <div class="points-content">
                <p>validade <input type="text" class="point-textbox" id="txt_validade"></p>
                <p>preço <input type="text" class="point-textbox" id="txt_preco"></p>
                <p>se completa <input type="text" class="point-textbox" id="txt_completa"></p>
                <p>se reseta após relogar <input type="text" class="point-textbox" id="txt_reseta_relogar"></p>
                <p>quantidade <input type="text" class="point-textbox" id="txt_quantidade"></p>
                <p>limitado ou ilimitado <input type="text" class="point-textbox" id="txt_limitado"></p>
                <p>data e data limite se estão corretas <input type="text" class="point-textbox" id="txt_data_limite_correta"></p>
                <p>item veio conforme o doc? <input type="text" class="point-textbox" id="txt_item_doc"></p>
            </div>

            <div class="points-header">Important points to note:</div>
            <div class="points-content">
                <p>expiration date <input type="text" class="point-textbox" id="txt_exp_date"></p>
                <p>price <input type="text" class="point-textbox" id="txt_price"></p>
                <p>completeness <input type="text" class="point-textbox" id="txt_completeness"></p>
                <p>reset after reload <input type="text" class="point-textbox" id="txt_reset_reload"></p>
                <p>quantity <input type="text" class="point-textbox" id="txt_quantity"></p>
                <p>limited or unlimited <input type="text" class="point-textbox" id="txt_limited_unlimited"></p>
                <p>date and expiry date are correct <input type="text" class="point-textbox" id="txt_date_expiry_correct"></p>
                <p>did the item come as per the doc? <input type="text" class="point-textbox" id="txt_item_as_doc"></p>
            </div>
        </div>
    </div>

    <div class="download-button-container">
        <select id="downloadFormat" style="padding: 8px; border-radius: 5px; margin-right: 10px;">
            <option value="json">JSON</option>
            <option value="pdf">PDF</option>
            <option value="docx">DOCX (Básico)</option>
        </select>
        <button class="download-button" id="downloadDataButton">Baixar Dados Preenchidos</button>
    </div>

    <script>
        // --- JavaScript para Salvar/Carregar Dados ---
        const STORAGE_KEY = 'staffDocsChecklist';

        // Função para salvar dados no localStorage
        function saveData() {
            const formData = {};
            document.querySelectorAll('input[type="checkbox"], input[type="date"], input[type="text"]').forEach(input => {
                if (input.id) { // Salvar apenas inputs com ID
                    if (input.type === 'checkbox') {
                        formData[input.id] = input.checked;
                    } else {
                        formData[input.id] = input.value;
                    }
                }
            });
            localStorage.setItem(STORAGE_KEY, JSON.stringify(formData));
            // console.log('Dados salvos:', formData); // Para depuração
        }

        // Função para carregar dados do localStorage
        function loadData() {
            const savedData = localStorage.getItem(STORAGE_KEY);
            if (savedData) {
                const formData = JSON.parse(savedData);
                document.querySelectorAll('input[type="checkbox"], input[type="date"], input[type="text"]').forEach(input => {
                    if (input.id && formData.hasOwnProperty(input.id)) {
                        if (input.type === 'checkbox') {
                            input.checked = formData[input.id];
                        } else {
                            input.value = formData[input.id];
                        }
                    }
                });
                // console.log('Dados carregados:', formData); // Para depuração
            }
        }

        // Função para formatar a data no fuso horário de Brasília (BRT/BRST)
        function formatDateTimeBrasilia() {
            const now = new Date();
            // Retorna a data no formato YYYY-MM-DD para o input type="date"
            const date = new Intl.DateTimeFormat('fr-CA', { year: 'numeric', month: '2-digit', day: '2-digit', timeZone: 'America/Sao_Paulo' }).format(now);
            return { date };
        }

        // Adiciona event listeners para as checkboxes e o novo botão
        document.addEventListener('DOMContentLoaded', () => {
            loadData(); // Carrega os dados ao carregar a página

            // **IMPORTANTE**: Modificado para selecionar TODAS as checkboxes na página
            // para que a função de "marcar e preencher data" funcione para todas,
            // e o botão "Desmarcar Todas" possa resetar todas.
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                checkbox.addEventListener('change', (event) => {
                    // Tenta encontrar o input de data associado.
                    // Prioriza buscar dentro da mesma label, mas se não encontrar,
                    // pode ser um caso como o da coluna Geral (se houver checkbox individual lá)
                    // ou qualquer outra estrutura futura.
                    let dateInput = event.target.closest('label')?.querySelector('input[type="date"]');
                    
                    // Se a checkbox não estiver dentro de uma label que contenha o dateInput
                    // (como era o caso original da chk_geral_1), tenta buscar um dateInput próximo.
                    // No layout atual, todas as checkboxes com dateInputs estão dentro de labels.
                    // Manter esta verificação para robustez, caso o HTML seja alterado.
                    if (!dateInput) {
                        dateInput = event.target.nextElementSibling; // Verifica se o irmão seguinte é um date picker
                        if (dateInput && dateInput.type !== 'date') {
                            dateInput = null; // Não é um date picker, zera
                        }
                    }

                    if (dateInput) {
                        if (event.target.checked) {
                            const { date } = formatDateTimeBrasilia();
                            dateInput.value = date; // Preenche o campo de data
                        } else {
                            dateInput.value = ''; // Limpa o campo de data se desmarcado
                        }
                    }
                    saveData(); // Salva os dados após a alteração
                });
            });

            // Event listener para o botão "Desmarcar Todas"
            const clearAllButton = document.getElementById('clearAllCheckboxesButton');
            if (clearAllButton) {
                clearAllButton.addEventListener('click', () => {
                    document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                        checkbox.checked = false; // Desmarca a checkbox
                        // Encontra o input de data associado, seja dentro de uma label ou próximo.
                        let dateInput = checkbox.closest('label')?.querySelector('input[type="date"]');
                        if (!dateInput) {
                            dateInput = checkbox.nextElementSibling; // Verifica o irmão seguinte
                            if (dateInput && dateInput.type !== 'date') {
                                dateInput = null;
                            }
                        }

                        if (dateInput) {
                            dateInput.value = ''; // Limpa o campo de data
                        }
                    });
                    saveData(); // Salva o estado atualizado (tudo desmarcado)
                });
            }

            // Mantém os listeners para salvar dados dos campos de texto e data (individuais)
            document.querySelectorAll('input[type="date"], input[type="text"]').forEach(input => {
                input.addEventListener('input', saveData);
                input.addEventListener('change', saveData);
            });

            // Listener para o botão de download, agora com seleção de formato
            document.getElementById('downloadDataButton').addEventListener('click', () => {
                const format = document.getElementById('downloadFormat').value;
                downloadData(format); // Chama a função principal com o formato
            });
        });

        // Função principal para baixar os dados, agora recebendo o formato
        function downloadData(format) {
            if (format === 'json') {
                generateJson();
            } else if (format === 'pdf') {
                generatePdf();
            } else if (format === 'docx') {
                generateDocxBasic();
            } else {
                alert('Formato de download não suportado.');
            }
        }

        // Função para gerar JSON (mantida do seu código original)
        function generateJson() {
            const orderedData = [];
            function extractText(element) {
                if (!element) return '';
                let tempDiv = document.createElement('div');
                let clonedElement = element.cloneNode(true);
                clonedElement.querySelectorAll('input, br, button').forEach(i => i.remove());
                return clonedElement.textContent.trim();
            }

            const headers = [];
            document.querySelectorAll('.grid-header').forEach(header => {
                headers.push(header.textContent.trim());
            });
            orderedData.push({ type: 'headers', data: headers });

            const contentCells = document.querySelectorAll('.grid-container > .grid-cell:not(.updates-section)');
            const cellsPerRow = 4;

            for (let i = 0; i < contentCells.length; i += cellsPerRow) {
                let rowData = { type: 'row', columns: [] };
                for (let j = 0; j < cellsPerRow; j++) {
                    let cell = contentCells[i + j];
                    if (!cell) continue;

                    let cellItems = [];
                    const clearButton = cell.querySelector('.clear-all-button');
                    if (clearButton) {
                        cellItems.push({
                            type: 'button',
                            id: clearButton.id,
                            label: clearButton.textContent.trim()
                        });
                    }

                    cell.querySelectorAll('li').forEach(li => {
                        let checkbox = li.querySelector('input[type="checkbox"]');
                        let dateInput = li.querySelector('input[type="date"]');
                        if (checkbox && checkbox.id) {
                            cellItems.push({
                                id: checkbox.id,
                                label: extractText(checkbox.closest('label')),
                                checked: checkbox.checked,
                                date: dateInput ? dateInput.value : ''
                            });
                        }
                    });

                    if (!cell.querySelector('ul') && !clearButton) {
                        const generalBox = cell.querySelector('.first-column-box');
                        if (generalBox) {
                            const generalLabel = generalBox.querySelector('.checkbox-label');
                            if (generalLabel) {
                                cellItems.push({
                                    type: 'info_text_general',
                                    content: extractText(generalLabel)
                                });
                            }
                        }
                    }

                    const directCheckboxLabel = cell.querySelector('.checkbox-label > input[type="checkbox"]');
                    if (directCheckboxLabel && directCheckboxLabel.id.includes('_others')) {
                        let checkbox = directCheckboxLabel;
                        let dateInput = checkbox.closest('label')?.querySelector('input[type="date"]');
                        cellItems.push({
                            id: checkbox.id,
                            label: extractText(checkbox.closest('label')),
                            checked: checkbox.checked,
                            date: dateInput ? dateInput.value : ''
                        });
                    }
                    
                    rowData.columns.push(cellItems);
                }
                orderedData.push(rowData);
            }

            let updatesSection = document.querySelector('.updates-section');
            if (updatesSection) {
                let updatesData = { type: 'updates', items: [] };
                updatesSection.querySelectorAll('.checkbox-label').forEach(label => {
                    let checkbox = label.querySelector('input[type="checkbox"]');
                    let dateInput = label.querySelector('input[type="date"]');
                    if (checkbox && checkbox.id) {
                        updatesData.items.push({
                            id: checkbox.id,
                            label: extractText(label),
                            checked: checkbox.checked,
                            date: dateInput ? dateInput.value : ''
                        });
                    }
                });
                orderedData.push(updatesData);
            }

            let importantPointsSection = document.querySelector('.important-points-grid');
            if (importantPointsSection) {
                let pointsData = { type: 'important_points', columns: [] };
                importantPointsSection.querySelectorAll('.points-content').forEach((col, colIndex) => {
                    let columnItems = [];
                    col.querySelectorAll('p').forEach(p => {
                        let textbox = p.querySelector('input[type="text"]');
                        if (textbox && textbox.id) {
                            columnItems.push({
                                id: textbox.id,
                                label: extractText(p),
                                value: textbox.value
                            });
                        }
                    });
                    pointsData.columns.push(columnItems);
                });
                orderedData.push(pointsData);
            }

            const dataStr = JSON.stringify(orderedData, null, 4);
            const blob = new Blob([dataStr], { type: 'application/json;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            const now = new Date();
            const filename = `staff_docs_checklist_${now.getFullYear()}${(now.getMonth() + 1).toString().padStart(2, '0')}${now.getDate().toString().padStart(2, '0')}_${now.getHours().toString().padStart(2, '0')}${now.getMinutes().toString().padStart(2, '0')}${now.getSeconds().toString().padStart(2, '0')}.json`;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Nova função para gerar PDF
        function generatePdf() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('p', 'mm', 'a4'); // 'p' for portrait, 'mm' for millimeters, 'a4' for A4 size
            const element = document.querySelector('.main-content-wrapper'); // Capture the main content

            // Use html2canvas to render the HTML element into a canvas
            html2canvas(element, { 
                scale: 2, // Increase scale for better resolution in PDF
                useCORS: true, // If you have external images or fonts, enable this
                logging: true // Enable logging for debugging
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png'); // Get image data
                const imgWidth = 210; // A4 width in mm
                const pageHeight = 297; // A4 height in mm
                const imgHeight = canvas.height * imgWidth / canvas.width; // Calculate image height to maintain aspect ratio
                let heightLeft = imgHeight;

                let position = 0;

                // Add the first page
                doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;

                // Add more pages if content overflows
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    doc.addPage();
                    doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }

                // Save the PDF
                const now = new Date();
                const filename = `staff_docs_checklist_${now.getFullYear()}${(now.getMonth() + 1).toString().padStart(2, '0')}${now.getDate().toString().padStart(2, '0')}_${now.getHours().toString().padStart(2, '0')}${now.getMinutes().toString().padStart(2, '0')}${now.getSeconds().toString().padStart(2, '0')}.pdf`;
                doc.save(filename);
            }).catch(error => {
                console.error("Erro ao gerar PDF:", error);
                alert("Ocorreu um erro ao gerar o PDF. Verifique o console para detalhes.");
            });
        }

        // Nova função para gerar DOCX (básico, via HTML)
        function generateDocxBasic() {
            const mainContentElement = document.querySelector('.main-content-wrapper');
            // Clone o elemento para remover inputs e botões sem alterar o DOM original
            const clonedContent = mainContentElement.cloneNode(true);
            clonedContent.querySelectorAll('input, button').forEach(el => el.remove());

            const htmlContent = `
                <!DOCTYPE html>
                <html lang="pt-BR">
                <head>
                    <meta charset="UTF-8">
                    <title>STAFF DOCS - Checagem Semanal</title>
                    <style>
                        /* Inclua os estilos CSS essenciais para a renderização no Word */
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .grid-container { display: table; width: 100%; border-collapse: collapse; margin-bottom: 20px;}
                        .grid-header { display: table-cell; border: 1px solid #000; padding: 10px; text-align: center; font-weight: bold; background-color: #e0e0e0; color: #333;}
                        .grid-cell { display: table-cell; border: 1px solid #000; padding: 10px; vertical-align: top; }
                        .cell-list-item ul { list-style: none; padding: 0; margin: 0; }
                        .cell-list-item li { margin-bottom: 5px; padding-bottom: 5px; border-bottom: 1px dashed #ccc; display: block; }
                        .cell-list-item li:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
                        .updates-section { background-color: #FFEB3B; padding: 15px; border-radius: 5px; margin-top: 20px; }
                        .updates-section h3 { text-align: center; font-size: 1.1em; font-weight: bold; margin-bottom: 10px; }
                        .important-points-grid { display: table; width: 100%; border-collapse: collapse; margin-top: 30px; }
                        .points-header { display: table-cell; border: 1px solid #000; padding: 10px; text-align: center; font-weight: bold; background-color: #ADD8E6; }
                        .points-content { display: table-cell; border: 1px solid #000; padding: 10px; vertical-align: top; }
                        .points-content p { margin: 0; padding-bottom: 8px; border-bottom: 1px dashed #ccc; }
                        .points-content p:last-child { border-bottom: none; padding-bottom: 0; }
                    </style>
                </head>
                <body>
                    <h1>STAFF DOCS - Checagem Semanal</h1>
                    ${clonedContent.innerHTML}
                </body>
                </html>
            `;

            const blob = new Blob([htmlContent], { type: 'application/msword;charset=utf-8' }); // Tipo MIME para .doc
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            const now = new Date();
            // Nome do arquivo com extensão .doc
            const filename = `staff_docs_checklist_${now.getFullYear()}${(now.getMonth() + 1).toString().padStart(2, '0')}${now.getDate().toString().padStart(2, '0')}_${now.getHours().toString().padStart(2, '0')}${now.getMinutes().toString().padStart(2, '0')}${now.getSeconds().toString().padStart(2, '0')}.doc`;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            alert('O arquivo foi baixado como .doc. Ele pode ser aberto no Word, mas a formatação pode não ser idêntica à página web.');
        }

    </script>
</body>
</html>
